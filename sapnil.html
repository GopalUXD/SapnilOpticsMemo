<!DOCTYPE html>
<html>
<head>
    <title>Sapnil Optics</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6f9;
            margin: 20px;
        }
        .container { max-width: 1200px; margin: auto; }
        .card { background: #fff; padding: 25px; margin-bottom: 25px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        h2 { border-bottom: 2px solid #004aad; padding-bottom: 8px; margin-bottom: 20px; font-size: 20px; }
        h3 { margin-top: 20px; margin-bottom: 10px; font-size: 16px; }
        label { font-weight: bold; display: block; margin-bottom: 6px; font-size: 14px; }
        input, select { width: 100%; padding: 8px; border: 2px solid #004aad; border-radius: 4px; margin-bottom: 5px; font-size: 14px; }

        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); column-gap: 50px; row-gap: 20px; }
        .grid-5 { display: grid; grid-template-columns: repeat(5, 1fr); column-gap: 20px; row-gap: 15px; }

        .submit-btn { background: #004aad; color: white; padding: 12px; border: none; cursor: pointer; width: 100%; font-size: 15px; margin-top: 15px; }
        .submit-btn:hover { background: #ffcc00; color: black; }

        /* Centered header in form */
        .form-header { text-align: center; margin-bottom: 20px; font-size: 14px; line-height: 1.3; }
        .form-header div { margin: 2px 0; font-weight: bold; }

        /* Memo container */
        .memo-container { display: none; flex-direction: column; height: 90vh; gap: 10px; }
        .memo-copy { background: #fff; padding: 15px; border-radius: 6px; border: 2px solid #004aad; overflow-y: auto; font-size: 14px; }

        #customerCopy { display: none; } /* Hidden on screen */
        #showroomCopy { flex: 1 1 auto; height: 100%; } /* Full height on screen */

        table { width: 100%; border-collapse: collapse; margin-bottom: 5px; font-size: 13px; }
        td, th { padding: 4px 8px; border: 1px solid #004aad; text-align: left; vertical-align: top; }
        th { background: #004aad; color: white; font-size: 13px; }
        .totals td { border: none; padding: 2px 5px; }
        .totals tr td:first-child { font-weight: bold; }
        .customer-header { text-align: center; margin-bottom: 8px; font-size: 13px; }
        .customer-header div { margin: 2px 0; }

        .print-btn { background: #28a745; color: white; padding: 10px 15px; border: none; cursor: pointer; font-size: 14px; margin-top: 10px; border-radius: 4px; }
        .print-btn:hover { background: #218838; }

        @media (max-width: 900px) { .grid-2, .grid-5 { grid-template-columns: 1fr; } }

        /* Print: show both copies and hide print button */
        @media print {
            body * { visibility: hidden; }
            #finalMemo, #finalMemo * { visibility: visible; }
            #finalMemo { position: absolute; top: 0; left: 0; width: 100%; display: flex; flex-direction: column; }
            #customerCopy, #showroomCopy { display: block; flex: none; height: auto; }
            .print-btn { display: none !important; }
        }
    </style>
</head>
<body>

<div class="container">

    <!-- Form Header -->
    <div class="form-header">
        <div>Sapnil Optics</div>
        <div>Mobile: 01712841584 [Whatsapp], 01972841584</div>
        <div>Address: Shop-10, 67/2, Jigatola, Dhaka-1209 [Opposite of Jigatola Post office]</div>
    </div>

<form id="memoForm">

    <!-- Customer Info -->
    <div class="card">
        <h2>Customer Information</h2>
        <div class="grid-2">
            <div><label>Customer Name</label><input type="text" id="name" required></div>
            <div><label>Phone</label><input type="text" id="phone" required></div>
            <div><label>Address</label><input type="text" id="address" required></div>
            <div><label>Delivery Date</label><input type="date" id="delivery_date" required></div>
        </div>
    </div>

    <!-- Power Info -->
    <div class="card">
        <h2>Power Information</h2>
        <h3>Right Eye</h3>
        <div class="grid-5">
            <div><label>Sphere</label><input type="text" id="right_sphere"></div>
            <div><label>Cylinder</label><input type="text" id="right_cylinder"></div>
            <div><label>Axis</label><input type="text" id="right_axis"></div>
            <div><label>Add</label><input type="text" id="right_add"></div>
            <div><label>Prism</label><input type="text" id="right_prism"></div>
        </div>

        <h3>Left Eye</h3>
        <div class="grid-5">
            <div><label>Sphere</label><input type="text" id="left_sphere"></div>
            <div><label>Cylinder</label><input type="text" id="left_cylinder"></div>
            <div><label>Axis</label><input type="text" id="left_axis"></div>
            <div><label>Add</label><input type="text" id="left_add"></div>
            <div><label>Prism</label><input type="text" id="left_prism"></div>
        </div>
    </div>

    <!-- Product Info -->
    <div class="card">
        <h2>Product Information</h2>
        <div class="grid-2">
            <div><label>Product Quantity</label><input type="number" id="product_quantity"></div>
            <div><label>Product Price</label><input type="number" id="product_price"></div>
        </div>
    </div>

    <!-- Lens Info -->
    <div class="card">
        <h2>Lens Information</h2>
        <div class="grid-2">
            <div><label>Lens Quantity</label><input type="number" id="lens_quantity"></div>
            <div><label>Lens Price</label><input type="number" id="lens_price"></div>
        </div>
    </div>

    <!-- Billing -->
    <div class="card">
        <h2>Billing Section</h2>
        <div class="grid-2">
            <div><label>Net Amount</label><input type="number" id="net_amount" readonly></div>
            <div><label>Discount</label><input type="number" id="discount"></div>
            <div><label>Advance</label><input type="number" id="advance"></div>
        </div>
        <button class="submit-btn" type="submit">Generate Final Memo</button>
    </div>

</form>

<!-- Memo Output -->
<div id="finalMemo" class="memo-container">
    <div id="customerCopy" class="memo-copy"></div>
    <div id="showroomCopy" class="memo-copy"></div>
    <button class="print-btn" onclick="window.print()">Print Now</button>
</div>

</div>

<script>
// Calculate Net Amount automatically
function updateNetAmount() {
    const productPrice = Number(document.getElementById("product_price").value) || 0;
    const lensPrice = Number(document.getElementById("lens_price").value) || 0;
    document.getElementById("net_amount").value = (productPrice + lensPrice).toFixed(2);
}

// Add event listeners
document.getElementById("product_price").addEventListener("input", updateNetAmount);
document.getElementById("lens_price").addEventListener("input", updateNetAmount);

document.getElementById("memoForm").addEventListener("submit", function(e){
    e.preventDefault();
    this.style.display = "none";

    const name = document.getElementById("name").value;
    const phone = document.getElementById("phone").value;
    const address = document.getElementById("address").value;
    const delivery_date = document.getElementById("delivery_date").value;

    const right_sphere = document.getElementById("right_sphere").value;
    const right_cylinder = document.getElementById("right_cylinder").value;
    const right_axis = document.getElementById("right_axis").value;
    const right_add = document.getElementById("right_add").value;
    const right_prism = document.getElementById("right_prism").value;

    const left_sphere = document.getElementById("left_sphere").value;
    const left_cylinder = document.getElementById("left_cylinder").value;
    const left_axis = document.getElementById("left_axis").value;
    const left_add = document.getElementById("left_add").value;
    const left_prism = document.getElementById("left_prism").value;

    const product_quantity = Number(document.getElementById("product_quantity").value) || 0;
    const product_price = Number(document.getElementById("product_price").value) || 0;
    const lens_quantity = Number(document.getElementById("lens_quantity").value) || 0;
    const lens_price = Number(document.getElementById("lens_price").value) || 0;
    const discount = Number(document.getElementById("discount").value) || 0;
    const advance = Number(document.getElementById("advance").value) || 0;

    const net_total = product_price + lens_price;
    const payable_amount = net_total - discount;
    const due = payable_amount - advance;
    const invoice_no = phone.slice(-4) + '-' + Date.now().toString().slice(-5);

    const memoHTML = `
        <div class="customer-header">
            <div>Sapnil Optics</div>
            <div>Mobile: 01712841584 [Whatsapp], 01972841584</div>
            <div>Address: Shop-10, 67/2, Jigatola, Dhaka-1209 [Opposite of Jigatola Post office]</div>
        </div>
        <table>
            <tr>
                <td><strong>Invoice:</strong> ${invoice_no}</td>
                <td><strong>Name:</strong> ${name}</td>
                <td><strong>Phone:</strong> ${phone}</td>
            </tr>
            <tr>
                <td colspan="2"><strong>Address:</strong> ${address}</td>
                <td><strong>Delivery Date:</strong> ${delivery_date} after 8 PM</td>
            </tr>
        </table>

        <h3>Power Information</h3>
        <table>
            <tr><th></th><th>Sphere</th><th>Cylinder</th><th>Axis</th><th>Add</th><th>Prism</th></tr>
            <tr><td>Right Eye</td><td>${right_sphere}</td><td>${right_cylinder}</td><td>${right_axis}</td><td>${right_add}</td><td>${right_prism}</td></tr>
            <tr><td>Left Eye</td><td>${left_sphere}</td><td>${left_cylinder}</td><td>${left_axis}</td><td>${left_add}</td><td>${left_prism}</td></tr>
        </table>

        <h3>Product & Lens</h3>
        <table>
            <tr><th>Product Qty</th><th>Product Price</th><th>Lens Qty</th><th>Lens Price</th></tr>
            <tr><td>${product_quantity}</td><td>${product_price.toFixed(2)}</td><td>${lens_quantity}</td><td>${lens_price.toFixed(2)}</td></tr>
        </table>

        <h3>Billing</h3>
        <table class="totals">
            <tr><td>Net Amount:</td><td>${net_total.toFixed(2)}</td></tr>
            <tr><td>Discount:</td><td>${discount.toFixed(2)}</td></tr>
            <tr><td>Payable:</td><td>${payable_amount.toFixed(2)}</td></tr>
            <tr><td>Advance:</td><td>${advance.toFixed(2)}</td></tr>
            <tr><td>Due:</td><td>${due.toFixed(2)}</td></tr>
        </table>
    `;

    document.getElementById("showroomCopy").innerHTML = memoHTML;
    document.getElementById("customerCopy").innerHTML = memoHTML;
    document.getElementById("finalMemo").style.display = "flex";
});
</script>

</body>
</html>
